<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="report_invoice_document">
			<t t-call="sharevault_invoice.sharevault_invoice_external_layout">
                <div class="page">
                    <link href="/sharevault_invoice/static/src/css/reports.css" rel="stylesheet" type="text/css"/>
                    <div class="oe_structure"/>
                    <div class="row">
                        <div class="col-xs-6">
                           <!--  <div id="div_customer_address_shipping">
                                <b>Accounts Payable Email Address:</b>
                                <span t-field="o.partner_id.email"/>
                            </div> -->
                            <div id="div_customer_address_shipping">
                                <t t-if="o.quota_mb">
                                    <b>Storage:&#160;</b><span t-field="o.quota_mb"/>GB
                                </t><br/>
                                <t t-if="o.quota_pages">
                                    <b>Quota: Pages:&#160;</b><span t-field="o.quota_pages"/>
                                </t>
                            </div>
                        </div>
                        <div class="col-xs-6" style="margin-left:650px;">
                            <div id="div_customer_address_shipping">
                                <t t-if="o.term_start_date">
                                    <b>Term Start Date&#160;:&#160;</b><span t-field="o.term_start_date" t-options='{"format": "MM/dd/yyyy"}'/><br/>
                                </t>
                                <t t-if="o.term_end_date">
                                    <b>Term End Date&#160;:</b>&#160;<span t-field="o.term_end_date" t-options='{"format": "MM/dd/yyyy"}'/>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div id="project_name" t-if="o.sharevault_id">
                            <center><b>ShareVault Name: </b><span t-field="o.sharevault_id.sharevault_name"/></center>
                        </div>
                    </div>
                    <br/>
                    <table class="product-table table table-condensed" id="sharevault_table_invoice">
                        <thead>
                            <tr class="invoice_thead">
                                <th>PRODUCT CODE</th>
                                <th>DESCRIPTION</th>
                                <th>QTY</th>
                                <th>UNIT PRICE</th>
                                <th>AMOUNT</th>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody">
                            <t t-foreach="o.invoice_line_ids" t-as="l">
                                <t t-if="l_odd">
                                    <tr style="background-color: white;">
                                        <td class="inoice_data" width="15%"><span t-field="l.product_id.default_code"/></td>
                                        <td class="inoice_data">
                                            <t t-set="name" t-value="l.name"/>
                                            <span t-if="']' in name" t-esc="name.split(']')[1]"/>
                                            <span t-else="" t-esc="name"/>
                                        </td>
                                        <td class="text-right inoice_data">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-esc="'{:,.0f}'.format(l.quantity)"/>
                                            </t>
                                        </td>
                                        <td class="text-right inoice_data" width="15%">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-field="l.price_unit"/>
                                            </t>
                                        </td>
                                        <td class="text-right inoice_data" width="10%">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-esc="'{:,.2f}'.format(l.price_subtotal)"/>
                                            </t>
                                        </td>
                                    </tr>
                                </t>
                                <t t-if="l_even">
                                    <tr style="background-color: #EBF5FB;">
                                        <td class="inoice_data" width="15%"><span t-field="l.product_id.default_code"/></td>
                                        <td class="inoice_data">
                                            <t t-set="name" t-value="l.name"/>
                                            <span t-if="']' in name" t-esc="name.split(']')[1]"/>
                                            <span t-else="" t-esc="name"/>
                                        </td>
                                        <td class="text-right inoice_data">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-esc="'{:,.0f}'.format(l.quantity)"/>
                                            </t>
                                        </td>
                                        <td class="text-right inoice_data" width="15%">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-field="l.price_unit"/>
                                            </t>
                                        </td>
                                        <td class="text-right inoice_data" width="10%">
                                            <t t-if="l.display_type in ['line_note','line_section']">

                                            </t>
                                            <t t-if="not l.display_type in ['line_note','line_section']">
                                              <span t-esc="'{:,.2f}'.format(l.price_subtotal)"/>
                                            </t>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </tbody>
                        <tr>
                            <td colspan="3" rowspan="3" class="msg_title" style="vertical-align: middle;">
                                <b>Thank you for your business!</b>
                            </td>
                            <t t-if="o.amount_total">
                                <td class="invoice_total" width="15%">
                                    Subtotal&#160;:&#160;
                                </td>
                            </t>
                            <t t-if="o.amount_total">
                                <td class="invoice_total" width="10%">
                                    <span t-field="o.amount_total"/>
                                </td>
                            </t>
                        </tr>
                        <tr>
                            <t t-if="o.amount_paid">
                                <td class="invoice_total" width="15%">
                                    Payments Received&#160;:&#160;
                                </td>
                            </t>
                            <t t-if="o.amount_paid">
                                <td class="invoice_total" width="10%">
                                    <span t-field="o.amount_paid"/>
                                </td>
                            </t>
                        </tr>
                        <tr>
                            <t t-if="o.amount_residual">
                                <td class="invoice_total" width="15%">
                                    Total Amount Due&#160;:&#160;
                                </td>
                            </t>
                            <t t-if="o.amount_residual">
                                <td class="invoice_total" width="10%">
                                    <b><span t-field="o.amount_residual"/></b>
                                </td>
                            </t>
                        </tr>
                    </table>
                    <p class="note">Amounts are in US dollars and exclude taxes, duties and tariffs.</p>
                    <table class="product-table table table-condensed" id="sharevault_table_invoice">
                        <thead>
                            <tr class="notes_thead">
                                <th>NOTES</th>
                            </tr>
                        </thead>
                        <tr>
                            <td>
                                <span t-field="o.narration"/>
                                <br/><br/><br/>
                            </td>
                        </tr>
                    </table>
                    <table>
                        <tr class="bank_data">
                            <td>For ACH and Wire Transfer payment&#160;:&#160;</td>
                        </tr>
                        <tr class="bank_data">
                            <td>Account Name&#160;:&#160;Pandesa Corporation DBA ShareVault</td>
                        </tr>
                        <tr class="bank_data">
                            <td>Bank Name&#160;:&#160;Boston Private Bank &amp; Trust Company</td>
                        </tr>
                        <tr class="bank_data">
                            <td>Account Number&#160;:&#160;0020062711</td>
                        </tr>
                        <tr class="bank_data">
                            <td>Routing/ABA Number&#160;:&#160;011002343</td>
                        </tr>
                        <tr class="bank_data">
                            <td>Swift Code&#160;:&#160;BPTCUS33</td>
                        </tr>
                    </table>
                </div>
            </t>
        </template>


        <template id="report_invoice">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="sharevault_invoice.report_invoice_document"
                        t-lang="o.partner_id.lang"/>
                </t>
            </t>
        </template>

        <report
            id="report_invoice_call"
            string="Invoices (ShareVault)"
            model="account.move"
            report_type="qweb-pdf"
            name="sharevault_invoice.report_invoice"
            file="sharevault_invoice.report_invoice"
            attachment="(object.state in ('open','paid')) and ('SHAREVAULT_INV'+(object.number or '').replace('/','')+'.pdf')"/>

        <record id="paperformat_invoice" model="report.paperformat">
            <field name="name">Invoice (ShareVault)</field>
            <field name="default" eval="True"/>
            <field name="format">Letter</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">80</field>
            <field name="margin_bottom">10</field>
            <field name="header_spacing">75</field>
        </record>

        <record id="report_invoice_call" model="ir.actions.report">
            <field name="paperformat_id" ref="sharevault_invoice.paperformat_invoice"/>
        </record>
        <!-- QWeb Reports Inherited from base account mnodule-->
        <report
            id="account.account_invoices"
            model="account.move"
            string="Invoices"
            report_type="qweb-pdf"
            name="account.report_invoice_with_payments"
            file="account.report_invoice_with_payments"
            attachment="(object.state == 'posted') and ((object.name or 'INV').replace('/','_')+'.pdf')"
            print_report_name="(object._get_report_base_filename())"
            groups="account.group_account_invoice"
            menu="False"
        />
    </data>
</odoo>
