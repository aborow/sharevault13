<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <record id="send_lead_sms" model="base.automation">
            <field name="name">ShareVault: send SMS to team</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="trigger">on_create</field>
            <field name="active" eval="True"/>
            <field name="state">code</field>
            <field name="code">
if record.team_id:
    for tm in record.team_id.member_ids:
        if tm.mobile:
            base_url = request.env['ir.config_parameter'].get_param('web.base.url')
            base_url += '/web#id=%d&amp;view_type=form&amp;model=%s' % (record.id, record._name)
            env['sms.sms'].create({
                                    'number': tm.mobile,
                                    'body': 'New lead! %s' % base_url
                                    })
            </field>
        </record>
        <!-- Automated Action for Update Lead stages based on the score and lead type -->
        <record id="update_lead_stages" model="base.automation">
            <field name="name">ShareVault: Update Lead Stages</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="trigger">on_write</field>
            <field name="active" eval="True"/>
            <field name="state">code</field>
            <field name="code">
if record.type == 'lead':
    if record.lead_type == 'new' and record.score >= 40:
        stage = env['crm.stage'].search([('name', '=', 'Open')], limit=1)
        record.write({'stage_id': stage.id,
                       'lead_type': 'marketing_ql'})
            </field>
        </record>

        <!--<record id="ir_cron_lead_stage_update" model="ir.cron">
            <field name='name'>CRM: Update Lead Stages</field>
            <field name='interval_number'>1</field>
            <field name='interval_type'>days</field>
            <field name="numbercall">-1</field>
            <field name="active" eval="True"/>
            <field name="doall" eval="False"/>
            <field name="code">model.update_lead_stages()</field>
            <field name="state">code</field>
            <field name="model_id" ref="model_crm_lead"/>
        </record>-->

    </data>
</odoo>
