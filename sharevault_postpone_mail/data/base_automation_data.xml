<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <record id="postpone_remails" model="base.automation">
            <field name="name">ShareVault: postpone mail</field>
            <field name="model_id" ref="mail.model_mail_mail"/>
            <field name="trigger">on_create</field>
            <field name="active" eval="True"/>
            <field name="state">code</field>
            <field name="code">
no_days = []
counter = 0
for w in ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday']:
    if env['ir.config_parameter'].sudo().get_param('postpone_email_'+w):
        no_days.append(counter)
    counter += 1

log("NO WEEKDAYS: %s" % str(no_days))
no_days_count = len(no_days)
# If all days were set, this would cause an impossible situation, so
# if all days are set, we don't run the code
if no_days_count and no_days_count &lt; 7:
    log("GO!")
    for rec in records:
        if rec.message_type == 'email' and not rec.notification:
            # If the email is to be sent on a no_day, we try to find the
            # next yes date
            next_try = rec.date.weekday()
            while next_try in no_days:
                if next_try == 6:
                    next_try = 0
                else:
                    next_try += 1

            # Calculate the date, based on the next_try
            days_ahead = next_try - rec.date.weekday()
            if days_ahead &lt; 0 or days_ahead == 0:
                # Target day already happened this week
                days_ahead += 7
            rec.write({'scheduled_date': rec.date + datetime.timedelta(days_ahead)})

            </field>
        </record>

    </data>
</odoo>
